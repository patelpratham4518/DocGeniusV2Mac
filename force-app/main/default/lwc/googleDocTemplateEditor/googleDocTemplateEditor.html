<template>
    <div class="body">
        <div class="sub_body">
            <div class="tabSection">
                <div class="tabSection_sub">
                  <div class="homeBtn" onclick={cancel}>
                    <svg viewBox="0 0 24 24">
                      <g stroke-width="0"></g>
                      <g stroke-linecap="round" stroke-linejoin="round"></g>
                      <g>
                        <path
                          d="M21.71,11.29l-9-9a1,1,0,0,0-1.42,0l-9,9a1,1,0,0,0,1.42,1.42l.29-.3V20.3A1.77,1.77,0,0,0,5.83,22H8.5a1,1,0,0,0,1-1V16.1a1,1,0,0,1,1-1h3a1,1,0,0,1,1,1V21a1,1,0,0,0,1,1h2.67A1.77,1.77,0,0,0,20,20.3V12.41l.29.3a1,1,0,0,0,1.42,0A1,1,0,0,0,21.71,11.29Z">
                        </path>
                      </g>
                    </svg>
                  </div>
                  <div class="tab" data-name="contentTab" onclick={activeTab}>
                    <svg viewBox="0 0 24 24">
                      <path
                        d="M1 2V5H3V4H5V9H3.5V11H8.5V9H7V4H9V5H11V2H1ZM21 3H14V5H20V19H4V14H2V20C2 20.5523 2.44772 21 3 21H21C21.5523 21 22 20.5523 22 20V4C22 3.44772 21.5523 3 21 3Z">
                      </path>
                    </svg>
                    <div>Template Content</div>
                  </div>
                  <div class="tab" data-name="basicTab" onclick={activeTab}>
                    <svg viewBox="0 0 24 24">
                      <path
                        d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z">
                      </path>
                    </svg>
                    <div>Basic Details</div>
                  </div>
                 
                  <div class="templateName" onclick={activeTab} data-name="basicTab">
                    <div class="recordSVG" >
                      <svg viewBox="0 0 1024 1024">
                        <g stroke-width="0"></g>
                        <g stroke-linecap="round" stroke-linejoin="round"></g>
                        <g>
                          <path
                            d="M714 762.2h-98.2c-16.6 0-30 13.4-30 30s13.4 30 30 30H714c16.6 0 30-13.4 30-30s-13.4-30-30-30zM487.4 762.2H147.1c-16.6 0-30 13.4-30 30s13.4 30 30 30h340.3c16.6 0 30-13.4 30-30s-13.4-30-30-30z"
                            fill="#33CC99"></path>
                          <path d="M838.253 130.023l65.548 65.548-57.982 57.983-65.549-65.549z" fill="#6be6ff"></path>
                          <path
                            d="M743.7 955.9H195.8c-53.7 0-97.4-43.7-97.4-97.4V174.8c0-53.7 43.7-97.4 97.4-97.4H615c16.6 0 30 13.4 30 30s-13.4 30-30 30H195.8c-20.6 0-37.4 16.8-37.4 37.4v683.7c0 20.6 16.8 37.4 37.4 37.4h547.9c20.6 0 37.4-16.8 37.4-37.4v-395c0-16.6 13.4-30 30-30s30 13.4 30 30v395.1c0 53.6-43.7 97.3-97.4 97.3z"
                            fill="#000000"></path>
                          <path
                            d="M907.7 122.1l-39.2-39.2c-24-24-65.1-21.9-91.7 4.7L419.5 445 347 643.6l198.6-72.4L903 213.8c12.1-12.1 19.6-27.7 21.1-44 1.8-18.1-4.3-35.5-16.4-47.7zM512.6 519.3L447.5 543l23.7-65.1 264.7-264.7 40.9 41.7-264.2 264.4z m348-347.9l-41.3 41.3-40.9-41.7 40.9-40.9c3.1-3.1 6.2-3.9 7.6-3.9l37.6 37.6c-0.1 1.3-0.9 4.5-3.9 7.6z">
                          </path>
                        </g>
                      </svg>
                    </div> 
                    <div class="templateNameText">
                      {templateRecord.Template_Name__c}
                    </div>
                  </div>
                  <div class="activeTabBar"></div>
                </div>
              </div>
            
       
            <template lwc:if={webViewLink}>
                <template if:false={showPopup}>
                    
                            <div class="main">
                            <template lwc:if={webViewLink}>
                                <iframe src={webViewLink} onloadstart={iframeLoadnig} onload={iframeLoaded}></iframe>
                            </template>
                            <c-key-mapping-container 
                              class="fieldMappingContainer desicionContainer"
                              data-name="fieldMappingContainer" 
                              object-name={objectName} 
                              save-button-label="Save" 
                              preview-button-label="Save &#38; Preview"
                              cancel-button-label="Save &#38; Close" 
                              onsave={saveTemplateDataIframe} 
                              onpreview={handleSaveNPreviewIframe}
                              onclose={handleSaveNCloseIframe} 
                              ontogglemapping={showHideMappingContainer}></c-key-mapping-container>
                            </div>
                      
                        <div class="basicTab" >

                            <div class="desicionContainer updateDeatilContainer">
                              
                                <div class="basicDetails">
                                    <div class="basicDetails_sub">
                                        <div class="templateDetails">
                                          <div class="detailHeader">Template Basic Details</div>
                                          <div class="detailEditSection">
                                            <template lwc:if={showTempDetail}>
                                              <div class="previewTwise">
                                                <div class="previewField">
                                                  <div class="previewLabel">Template Name</div>
                                                  <lightning-input type="text"  value={templateRecord.Template_Name__c} variant="label-hidden" data-name="Template_Name__c" onkeyup={handleEditDetail} ></lightning-input>
                                                </div>
                                              </div>
                                              <div class="previewTwise">
                                                <div class="previewField">
                                                  <div class="previewLabel">Description</div>
                                                  <lightning-input type="text"  value={templateRecord.Description__c} variant="label-hidden" data-name="Description__c" onkeyup={handleEditDetail} ></lightning-input>
                                                </div>
                                              </div>
                                           
                                              <div class="editStatus">
                                                <span class="statusLabel">Status: </span>
                                                <div class="tempToggle">
                                                  <template lwc:if={templateRecord.Template_Status__c}>
                                                    
                                                    <input class="checkBox checked" type="checkbox" id={templateRecord.Id} data-name="Template_Status__c" onchange={handleEditDetail} style="display: none;" checked/>
                                                  </template>
                                                  <template lwc:else>
                                                    
                                                    <input class="checkBox" type="checkbox" id={templateRecord.Id} data-name="Template_Status__c" onchange={handleEditDetail} style="display: none;"/>
                                                  </template>
                                                  <label for={templateRecord.Id}> 
                                                    <div class="toggleDiv">
                                                      <div class="toggleBtnBg">
                                                        <div class="StatusText">
                                                          <span>Active</span>
                                                          <span>Inactive</span>
                                                        </div>
                                                      </div>
                                                    </div>
                                                  </label>
                                                </div>
                                              </div>
                                              <div class="previewTwise">
                                                <div class="previewField">
                                                  <div class="previewLabel">Source Object</div>
                                                  <lightning-input type="text" class="nonEditInput" value={templateRecord.Object_API_Name__c} variant="label-hidden" disabled="true"></lightning-input>
                                                </div>
                                                <div class="previewField">
                                                  <div class="previewLabel">Template Type</div>
                                                 
                                                  <lightning-input type="text" class="nonEditInput" value={templateRecord.Template_Type__c} variant="label-hidden" disabled="true"></lightning-input>
                                                </div>
                                              </div>
                                              <div class="previewTwise">
                                                <div class="previewField">
                                                  <div class="previewLabel">Google Doc Id</div>
                                                  <lightning-input 
                                                    type="text"
                                                    class="nonEditInput"
                                                    value={Google_Doc_Template_Id__c}
                                                    variant="label-hidden"
                                                    disabled="true"
                                                  ></lightning-input>
                                              </div>
                                              </div>
                                              <div class="previewTwise">
                                                <div class="previewField ">
                                                  <div class="previewLabel">Create Date and Time</div>
                                                  
                                                  <lightning-input type="datetime" class="nonEditInput" value={templateRecord.CreatedDate} variant="label-hidden" disabled="true"></lightning-input>
                                                </div>
                                                <div class="previewField">
                                                  <div class="previewLabel">Last Modified Date and Time</div>
                                                 
                                                  <lightning-input type="datetime" class="nonEditInput" value={templateRecord.LastModifiedDate} variant="label-hidden" disabled="true"></lightning-input>
                                                </div>
                                              </div>
                                              <div class="previewTwise">
                                                <div class="previewField ">
                                                  <div class="previewLabel">Create By</div>
                                                 
                                                  <lightning-input type="text" class="nonEditInput" value={templateRecord.CreatedBy.Name} variant="label-hidden" disabled="true"></lightning-input>
                                                </div>
                                                <div class="previewField">
                                                  <div class="previewLabel">Last Modified By</div>
        
                                                  <lightning-input type="text" class="nonEditInput" value={templateRecord.LastModifiedBy.Name} variant="label-hidden" disabled="true"></lightning-input>
                                                </div>
                                               
                                              </div>
                                            </template>
                                            </div>
                                        </div>
                                     
                                      </div>
                                </div>
                                <div class="buttonSection">
                               
                                    <button type="button" class="button cancel" onclick={cancelEditTemplate}>Cancel</button>
                                    <button type="button" class="button next" onclick={editTemplateDetails}>Save</button>
                                </div>
                              </div>
                        </div>
                </template>
            </template>
            
        </div>

    <template if:false={isSpinner}>
        <template if:true={showPopup}>
            <div class="section">
                <div class="main">
                    <div class="firstRow">
                        <div class="title">Select Google Document</div>
                        <div class="profile">
                            <div class="userData">
                                <div class="username">{profile.username} </div>
                                <div class="email">{profile.email}</div>
                            </div>
                            <img src={profile.photolink} alt="" srcset="" class="profileIcon">
                        </div>
                    </div>
                    <div class="secondRow">
                  
                        <div class="seachContainer">
                          <svg class="iconSection" viewBox="0 0 44 44" fill="none">
                            <path d="M21 29C25.4183 29 29 25.4183 29 21C29 16.5817 25.4183 13 21 13C16.5817 13 13 16.5817 13 21C13 25.4183 16.5817 29 21 29Z" stroke="#ABB7C2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M31 31.0002L26.7 26.7002" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                          <input class="searchInput" placeholder="Search..." type="text" onkeyup={handleSearch} value={serachString}/>
                        </div>
                        <div class="refresh-div">
                            <svg xmlns="http://www.w3.org/2000/svg" class="refresh" onclick={refreshDocs} viewBox="0 0 87 24" fill="none">
                                <path d="M3.08826 7.49303H5.02575C5.20258 7.49303 5.37216 7.56325 5.4972 7.68825C5.62223 7.81326 5.69247 7.98279 5.69247 8.15957C5.69247 8.33635 5.62223 8.50589 5.4972 8.63089C5.37216 8.75589 5.20258 8.82611 5.02575 8.82611H1.91883C1.742 8.82611 1.57242 8.75589 1.44738 8.63089C1.32235 8.50589 1.2521 8.33635 1.2521 8.15957V5.05616C1.2521 4.87938 1.32235 4.70984 1.44738 4.58484C1.57242 4.45984 1.742 4.38962 1.91883 4.38962C2.09565 4.38962 2.26524 4.45984 2.39027 4.58484C2.5153 4.70984 2.58555 4.87938 2.58555 5.05616V6.10929C3.72968 5.05809 5.15525 4.36274 6.68816 4.10815C8.22106 3.85355 9.79495 4.05075 11.2176 4.67564C12.6403 5.30053 13.8501 6.32608 14.6994 7.62703C15.5486 8.92798 16.0006 10.448 16 12.0015C16 14.1226 15.1573 16.1569 13.6571 17.6568C12.157 19.1568 10.1223 19.9996 8.00067 20C5.87876 20 3.84376 19.1573 2.34334 17.6573C0.842925 16.1573 0 14.1228 0 12.0015H1.33344C1.33344 13.7693 2.03588 15.4647 3.28623 16.7147C4.53658 17.9647 6.23241 18.6669 8.00067 18.6669C9.76892 18.6669 11.4648 17.9647 12.7151 16.7147C13.9655 15.4647 14.6679 13.7693 14.6679 12.0015C14.668 10.659 14.2625 9.34769 13.5047 8.23937C12.7468 7.13106 11.6718 6.27738 10.4205 5.79012C9.16911 5.30286 7.79976 5.20473 6.49169 5.50859C5.18363 5.81244 3.99784 6.50411 3.08959 7.49303H3.08826Z" fill="#00AEFF"/>
                                <path d="M33.351 18L30.791 13.552H29.399V18H27.575V6.88H31.415C32.2683 6.88 32.9883 7.02933 33.575 7.328C34.1723 7.62667 34.615 8.02667 34.903 8.528C35.2017 9.02933 35.351 9.58933 35.351 10.208C35.351 10.9333 35.1377 11.5947 34.711 12.192C34.295 12.7787 33.6497 13.1787 32.775 13.392L35.527 18H33.351ZM29.399 12.096H31.415C32.0977 12.096 32.6097 11.9253 32.951 11.584C33.303 11.2427 33.479 10.784 33.479 10.208C33.479 9.632 33.3083 9.184 32.967 8.864C32.6257 8.53333 32.1083 8.368 31.415 8.368H29.399V12.096ZM45.7644 13.376C45.7644 13.7067 45.743 14.0053 45.7004 14.272H38.9644C39.0177 14.976 39.279 15.5413 39.7484 15.968C40.2177 16.3947 40.7937 16.608 41.4764 16.608C42.4577 16.608 43.151 16.1973 43.5564 15.376H45.5244C45.2577 16.1867 44.7724 16.8533 44.0684 17.376C43.375 17.888 42.511 18.144 41.4764 18.144C40.6337 18.144 39.8764 17.9573 39.2044 17.584C38.543 17.2 38.0204 16.6667 37.6364 15.984C37.263 15.2907 37.0764 14.4907 37.0764 13.584C37.0764 12.6773 37.2577 11.8827 37.6204 11.2C37.9937 10.5067 38.511 9.97333 39.1724 9.6C39.8444 9.22667 40.6124 9.04 41.4764 9.04C42.3084 9.04 43.0497 9.22133 43.7004 9.584C44.351 9.94667 44.8577 10.4587 45.2204 11.12C45.583 11.7707 45.7644 12.5227 45.7644 13.376ZM43.8604 12.8C43.8497 12.128 43.6097 11.5893 43.1404 11.184C42.671 10.7787 42.0897 10.576 41.3964 10.576C40.767 10.576 40.2284 10.7787 39.7804 11.184C39.3324 11.5787 39.0657 12.1173 38.9804 12.8H43.8604ZM51.2554 10.672H49.6234V18H47.7834V10.672H46.7434V9.184H47.7834V8.56C47.7834 7.54667 48.05 6.81067 48.5834 6.352C49.1274 5.88267 49.9754 5.648 51.1274 5.648V7.168C50.5727 7.168 50.1834 7.27467 49.9594 7.488C49.7354 7.69067 49.6234 8.048 49.6234 8.56V9.184H51.2554V10.672ZM54.6959 10.464C54.9625 10.016 55.3145 9.66933 55.7519 9.424C56.1999 9.168 56.7279 9.04 57.3359 9.04V10.928H56.8719C56.1572 10.928 55.6132 11.1093 55.2399 11.472C54.8772 11.8347 54.6959 12.464 54.6959 13.36V18H52.8719V9.184H54.6959V10.464ZM67.0925 13.376C67.0925 13.7067 67.0712 14.0053 67.0285 14.272H60.2925C60.3458 14.976 60.6072 15.5413 61.0765 15.968C61.5458 16.3947 62.1218 16.608 62.8045 16.608C63.7858 16.608 64.4792 16.1973 64.8845 15.376H66.8525C66.5858 16.1867 66.1005 16.8533 65.3965 17.376C64.7032 17.888 63.8392 18.144 62.8045 18.144C61.9618 18.144 61.2045 17.9573 60.5325 17.584C59.8712 17.2 59.3485 16.6667 58.9645 15.984C58.5912 15.2907 58.4045 14.4907 58.4045 13.584C58.4045 12.6773 58.5858 11.8827 58.9485 11.2C59.3218 10.5067 59.8392 9.97333 60.5005 9.6C61.1725 9.22667 61.9405 9.04 62.8045 9.04C63.6365 9.04 64.3778 9.22133 65.0285 9.584C65.6792 9.94667 66.1858 10.4587 66.5485 11.12C66.9112 11.7707 67.0925 12.5227 67.0925 13.376ZM65.1885 12.8C65.1778 12.128 64.9378 11.5893 64.4685 11.184C63.9992 10.7787 63.4178 10.576 62.7245 10.576C62.0952 10.576 61.5565 10.7787 61.1085 11.184C60.6605 11.5787 60.3938 12.1173 60.3085 12.8H65.1885ZM72.0875 18.144C71.3942 18.144 70.7702 18.0213 70.2155 17.776C69.6715 17.52 69.2395 17.1787 68.9195 16.752C68.5995 16.3147 68.4288 15.8293 68.4075 15.296H70.2955C70.3275 15.6693 70.5035 15.984 70.8235 16.24C71.1542 16.4853 71.5648 16.608 72.0555 16.608C72.5675 16.608 72.9622 16.512 73.2395 16.32C73.5275 16.1173 73.6715 15.8613 73.6715 15.552C73.6715 15.2213 73.5115 14.976 73.1915 14.816C72.8822 14.656 72.3862 14.48 71.7035 14.288C71.0422 14.1067 70.5035 13.9307 70.0875 13.76C69.6715 13.5893 69.3088 13.328 68.9995 12.976C68.7008 12.624 68.5515 12.16 68.5515 11.584C68.5515 11.1147 68.6902 10.688 68.9675 10.304C69.2448 9.90933 69.6395 9.6 70.1515 9.376C70.6742 9.152 71.2715 9.04 71.9435 9.04C72.9462 9.04 73.7515 9.296 74.3595 9.808C74.9782 10.3093 75.3088 10.9973 75.3515 11.872H73.5275C73.4955 11.4773 73.3355 11.1627 73.0475 10.928C72.7595 10.6933 72.3702 10.576 71.8795 10.576C71.3995 10.576 71.0315 10.6667 70.7755 10.848C70.5195 11.0293 70.3915 11.2693 70.3915 11.568C70.3915 11.8027 70.4768 12 70.6475 12.16C70.8182 12.32 71.0262 12.448 71.2715 12.544C71.5168 12.6293 71.8795 12.7413 72.3595 12.88C72.9995 13.0507 73.5222 13.2267 73.9275 13.408C74.3435 13.5787 74.7008 13.8347 74.9995 14.176C75.2982 14.5173 75.4528 14.9707 75.4635 15.536C75.4635 16.0373 75.3248 16.4853 75.0475 16.88C74.7702 17.2747 74.3755 17.584 73.8635 17.808C73.3622 18.032 72.7702 18.144 72.0875 18.144ZM81.9944 9.04C82.6664 9.04 83.2637 9.184 83.7864 9.472C84.3197 9.76 84.7357 10.1867 85.0344 10.752C85.3437 11.3173 85.4984 12 85.4984 12.8V18H83.6904V13.072C83.6904 12.2827 83.493 11.68 83.0984 11.264C82.7037 10.8373 82.165 10.624 81.4824 10.624C80.7997 10.624 80.2557 10.8373 79.8504 11.264C79.4557 11.68 79.2584 12.2827 79.2584 13.072V18H77.4344V6.16H79.2584V10.208C79.5677 9.83467 79.957 9.54667 80.4264 9.344C80.9064 9.14133 81.429 9.04 81.9944 9.04Z" fill="#00AEFF"/>
                            </svg>
                        </div>
                        
                        
                    </div>

                    <template if:true={templates} >
                        <template if:true={templates.length}>
                            <div class="documents">
                                <template for:each={templates} for:item="template">
                                    <div class="docs-container hover-effect" key={template.id} data-id={template.id} onclick={handleTemplateClick}>
                                        <div class="docFirstRow">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 51" fill="none" class="small">
                                                <path d="M3.5625 0C1.59499 0 0 1.55683 0 3.47727V47.5227C0 49.4432 1.59499 51 3.5625 51H34.4375C36.405 51 38 49.4432 38 47.5227V13.9091L23.75 0H3.5625Z" fill="#4E8DF5"/>
                                                <path d="M3.5625 51.0001C1.59499 51.0001 0 49.4433 0 47.5228V46.9433C0 48.8637 1.59499 50.4206 3.5625 50.4206H34.4375C36.405 50.4206 38 48.8637 38 46.9433V47.5228C38 49.4433 36.405 51.0001 34.4375 51.0001H3.5625Z" fill="#417EE9"/>
                                                <path d="M3.5625 0C1.59499 0 0 1.55683 0 3.47727V4.05682C0 2.13637 1.59499 0.579545 3.5625 0.579545H24.3438L23.75 0H3.5625Z" fill="#639AF6"/>
                                                <path d="M38.0001 25.7899V13.9092L35.9219 11.8808H25.9002C25.1068 11.8808 24.7094 12.8172 25.2705 13.3648L38.0001 25.7899Z" fill="url(#paint0_linear_1450_51)"/>
                                                <path d="M23.75 0L38 13.9091H27.3125C25.345 13.9091 23.75 12.3523 23.75 10.4318V0Z" fill="#A6C5FA"/>
                                                <path d="M28.5 25.5H9.5V27.8182H28.5V25.5Z" fill="white"/>
                                                <path d="M28.5 30.1364H9.5V32.4545H28.5V30.1364Z" fill="white"/>
                                                <path d="M9.5 34.7727H28.5V37.0909H9.5V34.7727Z" fill="white"/>
                                                <path d="M23.75 39.4091H9.5V41.7273H23.75V39.4091Z" fill="white"/>
                                                <defs>
                                                <linearGradient id="paint0_linear_1450_51" x1="30.8751" y1="25.7899" x2="30.8751" y2="11.591" gradientUnits="userSpaceOnUse">
                                                <stop stop-color="#4E8DF5"/>
                                                <stop offset="1" stop-color="#3D6ACD"/>
                                                </linearGradient>
                                                </defs>
                                            </svg>
                                            <div class="docName">{template.name}</div>
                                        </div>
                                        <div class="docSecondRow">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 38 51" fill="none" class="big">
                                                <path
                                                    d="M3.5625 0C1.59499 0 0 1.55683 0 3.47727V47.5227C0 49.4432 1.59499 51 3.5625 51H34.4375C36.405 51 38 49.4432 38 47.5227V13.9091L23.75 0H3.5625Z"
                                                    fill="#4E8DF5" />
                                                <path
                                                    d="M3.5625 51.0001C1.59499 51.0001 0 49.4433 0 47.5228V46.9433C0 48.8637 1.59499 50.4206 3.5625 50.4206H34.4375C36.405 50.4206 38 48.8637 38 46.9433V47.5228C38 49.4433 36.405 51.0001 34.4375 51.0001H3.5625Z"
                                                    fill="#417EE9" />
                                                <path
                                                    d="M3.5625 0C1.59499 0 0 1.55683 0 3.47727V4.05682C0 2.13637 1.59499 0.579545 3.5625 0.579545H24.3438L23.75 0H3.5625Z"
                                                    fill="#639AF6" />
                                                <path
                                                    d="M38.0001 25.7899V13.9092L35.9219 11.8808H25.9002C25.1068 11.8808 24.7094 12.8172 25.2705 13.3648L38.0001 25.7899Z"
                                                    fill="url(#paint0_linear_1450_51)" />
                                                <path d="M23.75 0L38 13.9091H27.3125C25.345 13.9091 23.75 12.3523 23.75 10.4318V0Z" fill="#A6C5FA" />
                                                <path d="M28.5 25.5H9.5V27.8182H28.5V25.5Z" fill="white" />
                                                <path d="M28.5 30.1364H9.5V32.4545H28.5V30.1364Z" fill="white" />
                                                <path d="M9.5 34.7727H28.5V37.0909H9.5V34.7727Z" fill="white" />
                                                <path d="M23.75 39.4091H9.5V41.7273H23.75V39.4091Z" fill="white" />
                                                <defs>
                                                    <linearGradient x1="30.8751" y1="25.7899" x2="30.8751" y2="11.591" gradientUnits="userSpaceOnUse">
                                                        <stop stop-color="#4E8DF5" />
                                                        <stop offset="1" stop-color="#3D6ACD" />
                                                    </linearGradient>
                                                </defs>
                                            </svg>
                                        </div>
                                        <div class="docThirdRow">
                                            <div class="size">{template.size}</div>
                                            <div class="date">Date: {template.createdTime}</div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>

                        <template if:false={templates.length}>
                            <div class="emptySearch">
                                <svg class="emptyIcon" viewBox="0 0 180 180" fill="none" xmlns="http://www.w3.org/2000/svg">
                                  <ellipse opacity="0.1" cx="90" cy="174.6" rx="90" ry="5.4" fill="#00AEFF"/>
                                  <path fill-rule="evenodd" clip-rule="evenodd" d="M43.2 45C43.2 39.0353 48.0353 34.2 54 34.2H104.324C104.678 34.2 105.031 34.2174 105.381 34.2518V58.4196C105.381 62.3961 108.604 65.6196 112.581 65.6196H135V110.38C133.26 110 131.454 109.8 129.6 109.8C115.682 109.8 104.4 121.082 104.4 135C104.4 139.12 105.389 143.009 107.142 146.443H54C48.0353 146.443 43.2 141.608 43.2 135.643V45ZM109.38 150.043H54C46.0471 150.043 39.6 143.596 39.6 135.643V45C39.6 37.0471 46.0471 30.6 54 30.6H104.324C108.143 30.6 111.806 32.1171 114.506 34.8176L134.382 54.6939C137.083 57.3944 138.6 61.0571 138.6 64.8762V65.4916L138.6 65.6196H138.6V111.455C148.073 115.078 154.8 124.253 154.8 135C154.8 148.918 143.518 160.2 129.6 160.2C121.321 160.2 113.974 156.208 109.38 150.043ZM59.9272 56.3272C60.6301 55.6242 61.7698 55.6242 62.4728 56.3272L68.85 62.7044L75.2272 56.3272C75.9301 55.6242 77.0698 55.6242 77.7728 56.3272C78.4757 57.0301 78.4757 58.1698 77.7728 58.8728L71.3956 65.25L77.7728 71.6272C78.4757 72.3301 78.4757 73.4698 77.7728 74.1728C77.0698 74.8757 75.9301 74.8757 75.2272 74.1728L68.85 67.7956L62.4728 74.1728C61.7698 74.8757 60.6301 74.8757 59.9272 74.1728C59.2242 73.4698 59.2242 72.3301 59.9272 71.6272L66.3044 65.25L59.9272 58.8728C59.2242 58.1698 59.2242 57.0301 59.9272 56.3272ZM59.4 90.9C59.4 88.4147 61.4147 86.4 63.9 86.4H90.9C93.3853 86.4 95.4 88.4147 95.4 90.9C95.4 93.3853 93.3853 95.4 90.9 95.4H63.9C61.4147 95.4 59.4 93.3853 59.4 90.9ZM63.9 90C63.4029 90 63 90.4029 63 90.9C63 91.397 63.4029 91.8 63.9 91.8H90.9C91.397 91.8 91.8 91.397 91.8 90.9C91.8 90.4029 91.397 90 90.9 90H63.9ZM63.9 100.8C61.4147 100.8 59.4 102.815 59.4 105.3C59.4 107.785 61.4147 109.8 63.9 109.8H114.3C116.785 109.8 118.8 107.785 118.8 105.3C118.8 102.815 116.785 100.8 114.3 100.8H63.9ZM63 105.3C63 104.803 63.4029 104.4 63.9 104.4H114.3C114.797 104.4 115.2 104.803 115.2 105.3C115.2 105.797 114.797 106.2 114.3 106.2H63.9C63.4029 106.2 63 105.797 63 105.3ZM144.147 45.4063C142.965 43.7288 140.837 43.0043 138.877 43.6125C135.81 44.5643 134.562 48.2303 136.411 50.8557L140.334 56.4241C141.55 58.1499 142.208 60.2066 142.22 62.3176L142.258 69.1606C142.273 71.778 144.405 73.8888 147.022 73.8773C149.643 73.8657 151.757 71.7312 151.744 69.1107L151.708 61.6782C151.69 58.0467 150.559 54.508 148.467 51.5392L144.147 45.4063ZM139.944 47.0507C140.412 46.9053 140.921 47.0785 141.204 47.4796L145.524 53.6126C147.192 55.9795 148.094 58.8007 148.108 61.696L148.144 69.1285C148.148 69.7601 147.638 70.2745 147.006 70.2773C146.375 70.2801 145.862 69.7714 145.858 69.1405L145.82 62.2975C145.804 59.451 144.917 56.6778 143.277 54.3508L139.354 48.7824C138.912 48.1547 139.211 47.2783 139.944 47.0507ZM108 135C108 123.071 117.671 113.4 129.6 113.4C141.529 113.4 151.2 123.071 151.2 135C151.2 146.929 141.529 156.6 129.6 156.6C117.671 156.6 108 146.929 108 135ZM125.1 123.3C125.1 120.815 127.115 118.8 129.6 118.8C132.085 118.8 134.1 120.815 134.1 123.3V134.1C134.1 136.585 132.085 138.6 129.6 138.6C127.115 138.6 125.1 136.585 125.1 134.1V123.3ZM129.6 122.4C129.103 122.4 128.7 122.803 128.7 123.3V134.1C128.7 134.597 129.103 135 129.6 135C130.097 135 130.5 134.597 130.5 134.1V123.3C130.5 122.803 130.097 122.4 129.6 122.4ZM129.6 151.2C127.115 151.2 125.1 149.185 125.1 146.7C125.1 144.215 127.115 142.2 129.6 142.2C132.085 142.2 134.1 144.215 134.1 146.7C134.1 149.185 132.085 151.2 129.6 151.2ZM128.7 146.7C128.7 147.197 129.103 147.6 129.6 147.6C130.097 147.6 130.5 147.197 130.5 146.7C130.5 146.203 130.097 145.8 129.6 145.8C129.103 145.8 128.7 146.203 128.7 146.7Z" fill="#00AEFF"/>
                                </svg>
                                <div class="empty-text1">
                                  Search results not found...
                                </div>
                            </div>
                        </template>
                    
                    </template>

                    <template if:true={allTemplates}>     
                    <template if:false={allTemplates.length}>
                        <div class="emptySearch">
                            <svg xmlns="http://www.w3.org/2000/svg" class="emptyIcon" viewBox="0 0 160 161" fill="none">
                                <circle cx="80" cy="80" r="80" fill="#DFEAFD"/>
                                <path d="M63.2612 89H97.7382C100.644 89 102.999 86.6445 102.999 83.7388V40.7038L92.6149 31H63.2612C60.3555 31 58 33.3555 58 36.2612V83.7388C58 86.6445 60.3555 89 63.2612 89Z" fill="white"/>
                                <path d="M92.6157 31L103 40.7038H92.6157V31Z" fill="#00AEFF"/>
                                <path d="M95 44H66V45.6057H95V44ZM95 50.1309H66V51.7366H95V50.1309ZM95 56.2632H66V57.8689H95V56.2632ZM95 62.3941H66V64H95V62.3941Z" fill="#00AEFF"/>
                                <path d="M82.8385 86.6429L113.963 99.9338C116.636 101.075 119.818 99.875 121.072 97.2536L140.138 57.387L135.009 44.4025L108.462 33.0662C105.789 31.925 102.607 33.125 101.353 35.7464L80.2699 79.8304C79.0163 82.4518 80.1663 85.5018 82.8385 86.6429Z" fill="white"/>
                                <path d="M135.681 44.7047L140.654 57.6331L131.335 53.5217L135.681 44.7047Z" fill="#00AEFF"/>
                                <path d="M130.283 59.2559L104 47L103.321 48.4552L129.604 60.7111L130.283 59.2559ZM127.692 64.8124L101.409 52.5565L100.73 54.0117L127.013 66.2676L127.692 64.8124ZM125.1 70.3702L98.8173 58.1142L98.1388 59.5694L124.422 71.8254L125.1 70.3702ZM122.509 75.9267L96.2263 63.6707L95.5476 65.1262L121.831 77.3821L122.509 75.9267Z" fill="#00AEFF"/>
                                <path d="M46.1869 100.068L77.5475 86.3147C80.2085 85.1477 81.3193 82.0912 80.0286 79.4879L60.4088 39.9172L46.5362 35.1686L19.8183 46.8858C17.1572 48.0528 16.0464 51.1093 17.3371 53.7125L39.0315 97.4674C40.3223 100.071 43.5258 101.235 46.1869 100.068Z" fill="white"/>
                                <path d="M46.5366 35.1685L60.4092 39.9171L50.9483 44.0662L46.5366 35.1685Z" fill="#00AEFF"/>
                                <path d="M55.8878 46L30 59.0699L30.7236 60.5033L56.6114 47.4333L55.8878 46ZM58.6509 51.473L32.7631 64.5429L33.4868 65.9762L59.3746 52.9063L58.6509 51.473ZM61.4146 56.9471L35.5269 70.0171L36.2505 71.4504L62.1383 58.3805L61.4146 56.9471ZM64.1778 62.4201L38.29 75.49L39.0137 76.9236L64.9015 63.8536L64.1778 62.4201Z" fill="#00AEFF"/>
                                <g clip-path="url(#clip0_1521_442)">
                                <path d="M123.108 77.1611H37.9813C36.8329 77.1618 35.7317 77.5912 34.9196 78.3549C34.1075 79.1187 33.651 80.1543 33.6503 81.2344V154.69C33.651 155.77 34.1075 156.806 34.9196 157.57C35.7317 158.333 36.8329 158.763 37.9813 158.763H123.108C124.256 158.763 125.357 158.333 126.17 157.57C126.982 156.806 127.438 155.77 127.439 154.69V81.2344C127.438 80.1543 126.982 79.1185 126.17 78.3548C125.357 77.591 124.256 77.1617 123.108 77.1611Z" fill="white"/>
                                <path d="M117.504 133.238H43.5862C41.1944 133.238 39.2551 131.414 39.2551 129.165V64.2627C39.2551 62.0133 41.1944 60.1895 43.5862 60.1895H117.504C119.896 60.1895 121.835 62.0133 121.835 64.2627V129.165C121.835 131.414 119.896 133.238 117.504 133.238Z" fill="#00AEFF"/>
                                <path d="M40.6264 130.454V65.5524C40.6264 63.3029 42.5656 61.4791 44.9574 61.4791H118.875C119.72 61.4791 120.505 61.71 121.171 62.1033C120.405 60.955 119.051 60.1895 117.504 60.1895H43.5862C41.1944 60.1895 39.2551 62.0133 39.2551 64.2627V129.165C39.2551 130.62 40.0691 131.894 41.2901 132.614C40.8719 131.987 40.6264 131.249 40.6264 130.454V130.454Z" fill="url(#paint0_linear_1521_442)"/>
                                <path d="M108.409 73.9022H52.6815V76.8891H108.409V73.9022ZM108.409 85.3069H52.6815V88.2938H108.409V85.3069ZM108.409 96.7142H52.6815V99.701H108.409V96.7142ZM108.409 108.119H52.6815V111.106H108.409V108.119Z" fill="white"/>
                                <path d="M59.3224 98.4783L73.3259 111.649H59.3224V98.4783Z" fill="url(#paint1_linear_1521_442)"/>
                                <path d="M127.439 112.735V82.4324L121.835 77.1611V112.735H127.439V112.735Z" fill="white"/>
                                <path d="M134.004 115.476L127.966 155.676C127.664 157.686 125.835 159.179 123.677 159.179H37.4126C35.2547 159.179 33.4259 157.686 33.124 155.676L24.9641 101.356C24.596 98.9041 26.6194 96.7131 29.2527 96.7131H55.893C58.0509 96.7131 59.8797 98.2068 60.1816 100.216L61.2509 107.33C61.5528 109.339 63.3816 110.833 65.5395 110.833H129.716C132.349 110.833 134.372 113.024 134.004 115.476H134.004Z" fill="url(#paint2_linear_1521_442)"/>
                                <path d="M112.61 141.248H48.4805C48.129 141.248 47.7896 141.128 47.5259 140.909C47.2622 140.691 47.0922 140.389 47.048 140.061L46.2456 134.087C46.2201 133.895 46.2381 133.701 46.2985 133.517C46.3588 133.333 46.46 133.163 46.5955 133.019C46.731 132.874 46.8976 132.759 47.0842 132.679C47.2709 132.6 47.4733 132.559 47.6781 132.559H113.412C113.617 132.559 113.819 132.6 114.006 132.679C114.193 132.759 114.359 132.874 114.495 133.019C114.63 133.163 114.731 133.333 114.792 133.517C114.852 133.701 114.87 133.895 114.845 134.087L114.042 140.061C113.998 140.389 113.828 140.691 113.564 140.909C113.301 141.128 112.961 141.248 112.61 141.248Z" fill="white"/>
                                </g>
                                <defs>
                                <linearGradient  x1="83.0846" y1="99.0978" x2="31.668" y2="44.4268" gradientUnits="userSpaceOnUse">
                                <stop stop-color="white"/>
                                </linearGradient>
                                <linearGradient  x1="68.5744" y1="113.762" x2="52.6851" y2="96.8675" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C2CECE" stop-opacity="0"/>
                                <stop offset="0.179" stop-color="#AFBCBC" stop-opacity="0.179"/>
                                <stop offset="1" stop-color="#5B6A6A"/>
                                </linearGradient>
                                <linearGradient  x1="79.484" y1="96.7131" x2="79.484" y2="159.179" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#EEF0F4"/>
                                <stop offset="0.927" stop-color="#00AEFF"/>
                                </linearGradient>
                                <clipPath >
                                <rect width="109.126" height="102.632" fill="white" transform="translate(24.9207 58.3684)"/>
                                </clipPath>
                                </defs>
                            </svg> 
                            <!-- <svg class="emptyIcon" viewBox="0 0 180 180" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <ellipse opacity="0.1" cx="90" cy="174.6" rx="90" ry="5.4" fill="#00AEFF"/>
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M43.2 45C43.2 39.0353 48.0353 34.2 54 34.2H104.324C104.678 34.2 105.031 34.2174 105.381 34.2518V58.4196C105.381 62.3961 108.604 65.6196 112.581 65.6196H135V110.38C133.26 110 131.454 109.8 129.6 109.8C115.682 109.8 104.4 121.082 104.4 135C104.4 139.12 105.389 143.009 107.142 146.443H54C48.0353 146.443 43.2 141.608 43.2 135.643V45ZM109.38 150.043H54C46.0471 150.043 39.6 143.596 39.6 135.643V45C39.6 37.0471 46.0471 30.6 54 30.6H104.324C108.143 30.6 111.806 32.1171 114.506 34.8176L134.382 54.6939C137.083 57.3944 138.6 61.0571 138.6 64.8762V65.4916L138.6 65.6196H138.6V111.455C148.073 115.078 154.8 124.253 154.8 135C154.8 148.918 143.518 160.2 129.6 160.2C121.321 160.2 113.974 156.208 109.38 150.043ZM59.9272 56.3272C60.6301 55.6242 61.7698 55.6242 62.4728 56.3272L68.85 62.7044L75.2272 56.3272C75.9301 55.6242 77.0698 55.6242 77.7728 56.3272C78.4757 57.0301 78.4757 58.1698 77.7728 58.8728L71.3956 65.25L77.7728 71.6272C78.4757 72.3301 78.4757 73.4698 77.7728 74.1728C77.0698 74.8757 75.9301 74.8757 75.2272 74.1728L68.85 67.7956L62.4728 74.1728C61.7698 74.8757 60.6301 74.8757 59.9272 74.1728C59.2242 73.4698 59.2242 72.3301 59.9272 71.6272L66.3044 65.25L59.9272 58.8728C59.2242 58.1698 59.2242 57.0301 59.9272 56.3272ZM59.4 90.9C59.4 88.4147 61.4147 86.4 63.9 86.4H90.9C93.3853 86.4 95.4 88.4147 95.4 90.9C95.4 93.3853 93.3853 95.4 90.9 95.4H63.9C61.4147 95.4 59.4 93.3853 59.4 90.9ZM63.9 90C63.4029 90 63 90.4029 63 90.9C63 91.397 63.4029 91.8 63.9 91.8H90.9C91.397 91.8 91.8 91.397 91.8 90.9C91.8 90.4029 91.397 90 90.9 90H63.9ZM63.9 100.8C61.4147 100.8 59.4 102.815 59.4 105.3C59.4 107.785 61.4147 109.8 63.9 109.8H114.3C116.785 109.8 118.8 107.785 118.8 105.3C118.8 102.815 116.785 100.8 114.3 100.8H63.9ZM63 105.3C63 104.803 63.4029 104.4 63.9 104.4H114.3C114.797 104.4 115.2 104.803 115.2 105.3C115.2 105.797 114.797 106.2 114.3 106.2H63.9C63.4029 106.2 63 105.797 63 105.3ZM144.147 45.4063C142.965 43.7288 140.837 43.0043 138.877 43.6125C135.81 44.5643 134.562 48.2303 136.411 50.8557L140.334 56.4241C141.55 58.1499 142.208 60.2066 142.22 62.3176L142.258 69.1606C142.273 71.778 144.405 73.8888 147.022 73.8773C149.643 73.8657 151.757 71.7312 151.744 69.1107L151.708 61.6782C151.69 58.0467 150.559 54.508 148.467 51.5392L144.147 45.4063ZM139.944 47.0507C140.412 46.9053 140.921 47.0785 141.204 47.4796L145.524 53.6126C147.192 55.9795 148.094 58.8007 148.108 61.696L148.144 69.1285C148.148 69.7601 147.638 70.2745 147.006 70.2773C146.375 70.2801 145.862 69.7714 145.858 69.1405L145.82 62.2975C145.804 59.451 144.917 56.6778 143.277 54.3508L139.354 48.7824C138.912 48.1547 139.211 47.2783 139.944 47.0507ZM108 135C108 123.071 117.671 113.4 129.6 113.4C141.529 113.4 151.2 123.071 151.2 135C151.2 146.929 141.529 156.6 129.6 156.6C117.671 156.6 108 146.929 108 135ZM125.1 123.3C125.1 120.815 127.115 118.8 129.6 118.8C132.085 118.8 134.1 120.815 134.1 123.3V134.1C134.1 136.585 132.085 138.6 129.6 138.6C127.115 138.6 125.1 136.585 125.1 134.1V123.3ZM129.6 122.4C129.103 122.4 128.7 122.803 128.7 123.3V134.1C128.7 134.597 129.103 135 129.6 135C130.097 135 130.5 134.597 130.5 134.1V123.3C130.5 122.803 130.097 122.4 129.6 122.4ZM129.6 151.2C127.115 151.2 125.1 149.185 125.1 146.7C125.1 144.215 127.115 142.2 129.6 142.2C132.085 142.2 134.1 144.215 134.1 146.7C134.1 149.185 132.085 151.2 129.6 151.2ZM128.7 146.7C128.7 147.197 129.103 147.6 129.6 147.6C130.097 147.6 130.5 147.197 130.5 146.7C130.5 146.203 130.097 145.8 129.6 145.8C129.103 145.8 128.7 146.203 128.7 146.7Z" fill="#00AEFF"/>
                            </svg> -->
                            
                              <div class="empty-text1">
                                  No Document files yet...
                              </div>
                              <div class="empty-text2">
                                  Please upload documents in your Google Drive.
                              </div>
                            
                        </div>
                    </template>
                    </template>
 
                    <div class="footer">
                        <button type="button" class="button cancel" onclick={cancel}>Cancel</button>
                        <button type="button" class="button next" onclick={next} disabled>Next</button>
                    </div> 
                </div>
            </div>
        </template>
    </template>
        <c-document-loader display={isSpinner} fix-top="true"  label={loaderLabel}></c-document-loader>
        <c-message-popup></c-message-popup>
        <template lwc:if={isPreview}>
            <c-template-preview-modal templateid={templateId} objectname={objectName}
              objectlabel={objectlabel} onclosepreview={closeTemplatePreview}></c-template-preview-modal>
        </template>
    </div>
</template>